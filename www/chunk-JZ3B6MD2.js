import{a as te,k as ie,l as oe}from"./chunk-GSNGTXPM.js";import{a as ne}from"./chunk-ILVZZ3VC.js";import{c as I,g as C,h as B,k as b}from"./chunk-ZAFSEONU.js";import{$ as m,C as s,Ca as q,D as p,Da as z,F as E,I as j,K as c,L as l,M as d,N as u,R as U,S as x,T as v,Xa as X,Ya as G,aa as V,ba as D,ca as M,cb as J,da as F,ea as k,gb as K,j as T,ka as O,l as R,ma as N,oa as W,qb as Q,s as _,sa as L,sb as Y,t as y,wb as Z,xb as ee,ya as H,za as $}from"./chunk-SVTJ7FR3.js";import"./chunk-N3PT3BRI.js";import"./chunk-7KGURMOZ.js";import"./chunk-5TFNS7IN.js";import"./chunk-QKUHOLOF.js";import"./chunk-6DP5AXAB.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-QXT6YJJ4.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as h}from"./chunk-RW4GY4BD.js";var r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));function re(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}var S,ce=new Uint8Array(16);function w(){if(!S){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");S=crypto.getRandomValues.bind(crypto)}return S(ce)}var ue=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),A={randomUUID:ue};function le(e,t,a){var o,n,g;if(A.randomUUID&&!t&&!e)return A.randomUUID();e=e||{};let i=(g=(n=e.random)!=null?n:(o=e.rng)==null?void 0:o.call(e))!=null?g:w();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){if(a=a||0,a<0||a+16>t.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`);for(let f=0;f<16;++f)t[a+f]=i[f];return t}return re(i)}var P=le;var ae=(()=>{let t=class t{constructor(i){this.firestore=i}generarCodigo(i){return h(this,null,function*(){let o=P().substring(0,6).toUpperCase(),n=C(this.firestore,`parejas/${o}`);return yield b(n,{usuario1:i,recuerdos:[]}),o})}unirAPareja(i,o){return h(this,null,function*(){let n=C(this.firestore,`parejas/${o}`);return(yield B(n)).exists()?(yield b(n,{usuario2:i},{merge:!0}),!0):!1})}};t.\u0275fac=function(o){return new(o||t)(R(I))},t.\u0275prov=T({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function ge(e,t){e&1&&u(0,"section")}function fe(e,t){e&1&&u(0,"section")}function he(e,t){e&1&&u(0,"section")}function ve(e,t){e&1&&u(0,"section")}function _e(e,t){e&1&&u(0,"section")}function ye(e,t){e&1&&u(0,"ion-icon",11)}function xe(e,t){e&1&&u(0,"ion-icon",12)}function Ie(e,t){if(e&1){let a=U();l(0,"section"),m(1," Comparte este c\xF3digo con tu pareja para compartir sus recuerdos: "),l(2,"ion-title"),m(3),j(4,ye,1,0,"ion-icon",8)(5,xe,1,0,"ion-icon",9),d(),l(6,"ion-button",2),x("click",function(){_(a);let o=v();return y(o.generarCodigo())}),m(7,"Mostrar c\xF3digo"),d(),u(8,"br"),m(9," O introduce aqu\xED el codigo de tu pareja: "),u(10,"br"),l(11,"ion-input",10),k("ngModelChange",function(o){_(a);let n=v();return F(n.inputCodigo,o)||(n.inputCodigo=o),y(o)}),d(),l(12,"ion-button",2),x("click",function(){_(a);let o=v();return y(o.unirAPareja())}),m(13,"Conectar"),d()()}if(e&2){let a=v();s(3),D("",a.codigo," "),s(),c("ngIf",!a.mostrarCodigo),s(),c("ngIf",a.mostrarCodigo),s(6),M("ngModel",a.inputCodigo)}}function je(e,t){e&1&&u(0,"section")}var qe=(()=>{let t=class t{constructor(i,o,n,g,f,se){this.router=i,this.location=o,this.platform=n,this.syncService=g,this.dataService=f,this.firestore=se,this.titulo="",this.codigo="- - - - - -",this.inputCodigo="",this.mostrarCodigo=!1,te({eyeOutline:oe,eyeOffOutline:ie})}generarCodigo(){return h(this,null,function*(){if(this.dataService.codigoPareja)this.codigo=this.dataService.codigoPareja;else try{let i="usuario1@example.com";this.codigo=yield this.syncService.generarCodigo(i),this.dataService.codigoPareja=this.codigo}catch{console.log("ERROR")}this.mostrarCodigo=!0,this.dataService.subirRecuerdosAFirebase(this.codigo,this.dataService.getRecuerdos(),this.firestore),this.dataService.syncRecuerdos()})}unirAPareja(){return h(this,null,function*(){if(this.inputCodigo.trim())try{(yield this.syncService.unirAPareja("usuario2@example.com",this.inputCodigo))?(console.log("\xA1Conexi\xF3n exitosa!"),this.codigo=this.inputCodigo.trim(),this.dataService.codigoPareja=this.codigo,console.log("Codigo introducido:",this.dataService.codigoPareja),this.dataService.subirRecuerdosAFirebase(this.codigo,this.dataService.getRecuerdos(),this.firestore),this.dataService.syncRecuerdos(),this.router.navigate(["/tabs/tab1"])):console.log("C\xF3digo inv\xE1lido. Int\xE9ntalo de nuevo.")}catch{console.log("Error al unirse con la pareja.")}})}volver(){this.location.back()}ionViewWillEnter(){this.platform.backButton.subscribeWithPriority(10,()=>{this.router.navigate(["/opciones"])})}ngOnInit(){let i=this.router.getCurrentNavigation();i!=null&&i.extras.state&&(this.titulo=i.extras.state.data)}};t.\u0275fac=function(o){return new(o||t)(p(L),p(O),p(z),p(ae),p(ne),p(I))},t.\u0275cmp=E({type:t,selectors:[["app-ajustes"]],decls:19,vars:10,consts:[[3,"translucent"],["slot","start"],[3,"click"],["slot","icon-only","name","chevron-back"],[3,"fullscreen"],["collapse","condense"],["size","large"],[4,"ngIf"],["name","eye-off-outline",4,"ngIf"],["name","eye-outline",4,"ngIf"],["label","Introducir c\xF3digo","label-placement","floating","fill","solid","placeholder","C\xF3digo de tu pareja",3,"ngModelChange","ngModel"],["name","eye-off-outline"],["name","eye-outline"]],template:function(o,n){o&1&&(l(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),x("click",function(){return n.volver()}),u(4,"ion-icon",3),d()(),l(5,"ion-title"),m(6),d()()(),l(7,"ion-content",4)(8,"ion-header",5)(9,"ion-toolbar")(10,"ion-title",6),m(11,"ajustes"),d()()(),j(12,ge,1,0,"section",7)(13,fe,1,0,"section",7)(14,he,1,0,"section",7)(15,ve,1,0,"section",7)(16,_e,1,0,"section",7)(17,Ie,14,4,"section",7)(18,je,1,0,"section",7),d()),o&2&&(c("translucent",!0),s(6),V(n.titulo),s(),c("fullscreen",!0),s(5),c("ngIf",n.titulo=="Apodos"),s(),c("ngIf",n.titulo=="Aniversario"),s(),c("ngIf",n.titulo=="\xC1lbum"),s(),c("ngIf",n.titulo=="Men\xFA"),s(),c("ngIf",n.titulo=="Tema"),s(),c("ngIf",n.titulo=="Compartir recuerdos"),s(),c("ngIf",n.titulo=="Acerca de"))},dependencies:[J,K,Q,Y,W,N,q,H,$,G,X,Z,ee],encapsulation:2});let e=t;return e})();export{qe as AjustesPage};
